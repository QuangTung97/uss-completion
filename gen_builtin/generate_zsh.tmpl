_completion_remove_quote() {
  local input="$1"
  if [[ "$input" == \"* ]]; then
    echo "${input#\"}"
  else
    echo "${input#\'}"
  fi
}
{{- range .Commands }}

# -----------------------------------
# uss completion wrapper for {{ .Name }}
# -----------------------------------
if [[ -z "$COMPLETION_USS_{{ .NameUpper }}_FUNC" ]]; then
  COMPLETION_USS_{{ .NameUpper }}_FUNC=$_comps[{{ .Name }}]
fi

_completion_uss_{{ .Name }}() {
  local last_word="${words[$CURRENT]}"
  local last_word_trim="$(_completion_remove_quote "$last_word")"

  if [[ "$last_word_trim" == "uss"* ]]; then
    local -a results
    results=("${(@f)$(GO_FLAGS_COMPLETE_URI=1 GO_FLAGS_SHELL=zsh uss "$last_word")}")
    _zsh_add_completion_item "${results[@]}"
    return 0
  else
    # call the underlying completion
    $COMPLETION_USS_{{ .NameUpper }}_FUNC
  fi
}

compdef _completion_uss_{{ .Name }} {{ .Name }}
{{- end }}
